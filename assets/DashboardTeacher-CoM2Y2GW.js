import{c as ie,r as a,j as e,G as U,U as Ue,a as Re,L as _e,C as se,b as Le,d as D,e as V,f as ze,g as $e,X as ve,h as Ve,D as qe,A as We,i as b,p as Be,k as Je,l as Qe,R as Xe,M as Ze,S as Ke,B as es,m as ss,n as ts,o as as,u as ls,q as rs,H as ns,F as ds,Z as os}from"./index-OAThCskr.js";import cs from"./ExamsTab-Crsktkwi.js";import{F as is}from"./file-spreadsheet-DXFR7zHY.js";import{H as xs}from"./hard-drive-Dn8vgDdL.js";import{P as ms}from"./printer-Bnb0rAQ2.js";import{T as Ye}from"./trash-2-DnLDp265.js";import{P as hs}from"./pen-square-B2LQG___.js";import{A as us,S as Oe,P as bs}from"./settings-2-BBLRfk33.js";import{C as ps}from"./calendar-days-Ct7zuPGL.js";import{S as Ge}from"./save-D7gJF2D6.js";import{P as gs}from"./plus-fJcaQoMN.js";import{B as He}from"./bell-B8ecUKwm.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=ie("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=ie("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=ie("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=ie("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=ie("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),ks=({user:r,students:y,pendingAdmissions:m,stats:v,sortingMethod:p,onRefresh:S,onDeleteStudent:P,onAdmissionAction:A,onCleanJunk:w})=>{const[f,E]=a.useState(!1),[d,u]=a.useState({regNo:"",rollNo:"",name:"",dob:"",gender:"",fatherName:"",motherName:"",photoUrl:""}),[B,R]=a.useState(!1),[Y,F]=a.useState({name:!1,dob:!1,gender:!1}),[G,I]=a.useState(""),[z,k]=a.useState(""),[l,x]=a.useState(!1),[o,M]=a.useState(!1),[W,te]=a.useState(!1),[J,xe]=a.useState("UPLOAD"),[Ie,me]=a.useState(null),[L,ae]=a.useState([]),[le,we]=a.useState([]),[re,he]=a.useState(!1),[ke,q]=a.useState([]),[ne,ue]=a.useState(0),[c,$]=a.useState({name:"",regNo:"",rollNo:"",gender:"",dob:"",phone:"",fatherName:"",motherName:"",address:""}),[O,de]=a.useState(null),[Q,K]=a.useState(!1),[N,H]=a.useState({}),[ee,be]=a.useState(""),[X,ye]=a.useState([]),[pe,ge]=a.useState(!1),_=r.submissionStatus==="SUBMITTED"||r.submissionStatus==="APPROVED";a.useEffect(()=>{(async()=>{const n=await b.getClasses();ye(n.filter(i=>i.id!==r.id))})()},[r.id]);const Se=a.useMemo(()=>{const s=p||"BOYS_FIRST";if(s==="BOYS_FIRST"||s==="GIRLS_FIRST"){const n=y.filter(j=>j.gender==="Male").sort((j,h)=>(j.rollNo||9999)-(h.rollNo||9999)),i=y.filter(j=>j.gender!=="Male").sort((j,h)=>(j.rollNo||9999)-(h.rollNo||9999));return s==="BOYS_FIRST"?[...n,...i]:[...i,...n]}return[...y].sort((n,i)=>s==="ROLL_ONLY"?(n.rollNo||9999)-(i.rollNo||9999):s==="NAME_ONLY"?n.name.localeCompare(i.name):0)},[y,p]),Ce=s=>{d[s]?F(n=>({...n,[s]:!1})):F(n=>({...n,[s]:!0}))},Te=async s=>{if(!s.target.files||s.target.files.length===0)return;if(!r.isPro){alert("Photo upload is an Elite/Pro feature.");return}M(!0);const n=s.target.files[0],i=await b.uploadImage(n,"students");M(!1),i.success&&i.publicUrl?(u(j=>({...j,photoUrl:i.publicUrl})),x(!1)):alert("Upload failed: "+i.message)},Ae=async s=>{if(s.preventDefault(),_){alert("Class is locked/submitted. Ask admin to unlock before adding students.");return}k(""),I(""),F({name:!1,dob:!1,gender:!1});let n=!1;if(d.name||(F(h=>({...h,name:!0})),n=!0),d.dob||(F(h=>({...h,dob:!0})),n=!0),d.gender||(F(h=>({...h,gender:!0})),n=!0),n){k("âš ï¸ Please fill Name, DOB & Gender!");return}R(!0);const i={...d,fatherName:d.fatherName||"Not Entered",motherName:d.motherName||"Not Entered",addedBy:r.teacherName||"Class Teacher"};if(!i.photoUrl){const h=i.name||"Felix";i.photoUrl=`https://api.dicebear.com/7.x/avataaars/svg?seed=${h}&gender=${i.gender==="Female"?"female":"male"}`}const j=await b.createStudent(r.id,i);R(!1),j.success?(I(`âœ… ${d.name} Added!`),u({regNo:"",rollNo:"",name:"",dob:"",gender:"",fatherName:"",motherName:"",photoUrl:""}),S(),setTimeout(()=>I(""),2500)):alert("Failed: "+j.message)},Me=()=>{const s=["Name","RegNo","RollNo","Gender","DOB","FatherName","MotherName","Phone","Address"],n=["John Doe","1001","1","Male","2010-05-20","Father Name","Mother Name","9999999999","House Address"],i="data:text/csv;charset=utf-8,"+[s.join(","),n.join(",")].join(`
`),j=encodeURI(i),h=document.createElement("a");h.setAttribute("href",j),h.setAttribute("download",`Class_${r.name.replace(/\s/g,"_")}_Template.csv`),document.body.appendChild(h),h.click(),document.body.removeChild(h)},Pe=async s=>{var Z;const n=(Z=s.target.files)==null?void 0:Z[0];if(!n)return;me(n);const j=(await n.text()).split(`
`).filter(g=>g.trim());if(j.length<2)return alert("File appears to be empty or missing data rows.");const h=Be(j[0]).map(g=>g.trim());ae(h),we(j.slice(1));const T={...c};h.forEach(g=>{const C=g.toLowerCase();C.includes("name")&&!C.includes("father")&&!C.includes("mother")?T.name=g:C.includes("reg")||C.includes("adm")?T.regNo=g:C.includes("roll")?T.rollNo=g:C.includes("gender")?T.gender=g:C.includes("dob")?T.dob=g:C.includes("phone")?T.phone=g:C.includes("father")?T.fatherName=g:C.includes("mother")?T.motherName=g:C.includes("address")&&(T.address=g)}),$(T),xe("MAP")},Ee=async()=>{if(!c.name)return alert("Name column is required.");xe("PROCESS"),he(!0),q([]),ue(0);try{let s=0;const n=L;for(let i=0;i<le.length;i++){const j=Be(le[i]),h=C=>{var Ne;const je=n.indexOf(C);return je!==-1?(Ne=j[je])==null?void 0:Ne.trim():""},T=h(c.name);if(!T)continue;const Z={name:T,regNo:h(c.regNo)||`TMP-${Date.now()}-${i}`,rollNo:h(c.rollNo),gender:c.gender&&h(c.gender)||"Male",dob:c.dob?Je(h(c.dob)):"2000-01-01",fatherName:h(c.fatherName)||"-",motherName:h(c.motherName)||"-",phone:c.phone?h(c.phone):"",customData:{address:h(c.address)},addedBy:r.teacherName||"Smart Import"},g=await b.createStudent(r.id,Z);g.success?s++:q(C=>[...C,`Failed: ${T} - ${g.message}`]),ue(Math.round((i+1)/le.length*100))}q(i=>[...i,`âœ… Imported ${s} students successfully!`]),S()}catch(s){q(n=>[...n,`ERROR: ${s.message}`])}finally{he(!1)}},De=s=>{de(s),H({...s}),K(!1),be("")},Fe=async()=>{if(_)return alert("Class is locked.");await b.updateStudentDetails(O.id,N),A(O.id,"APPROVE"),fe(null)},oe=async()=>{if(!ee||!O)return;ge(!0);const s=await b.transferStudentAdmission(O.id,ee);ge(!1),s.success?(alert("Student Transferred Successfully!"),de(null),S()):alert("Transfer failed: "+s.message)},fe=s=>{de(s),K(!1),H({})},ce=`${window.location.origin}/#/register?schoolId=${r.schoolId}&classId=${r.id}`,t=`Dear Parents,

Admission for *${r.name}* is now open.
Please register your child using the link below:

ðŸ”— ${ce}

Thank you,
${r.teacherName||"Class Teacher"}`;return e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 animate-fade-in-up",children:[e.jsxs("div",{className:"md:col-span-1 space-y-6",children:[e.jsxs(U,{className:"bg-gradient-to-br from-indigo-600 to-purple-700 text-white border-none relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-20",children:e.jsx(Ue,{className:"w-24 h-24"})}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Smart Invite"}),e.jsx("p",{className:"text-xs text-indigo-200 mb-4",children:"Share this link with parents for self-registration."}),e.jsx("div",{className:"bg-black/20 p-2 rounded-lg text-[10px] font-mono mb-4 break-all truncate border border-white/10",children:ce}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>window.open(`https://wa.me/?text=${encodeURIComponent(t)}`,"_blank"),className:"flex-1 bg-[#25D366] hover:bg-[#20bd5a] text-white py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-1 shadow-lg",children:"WhatsApp"}),e.jsx("button",{onClick:()=>navigator.clipboard.writeText(ce),className:"flex-1 bg-white/10 hover:bg-white/20 text-white py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-1",children:"Copy Link"})]})]}),e.jsxs(U,{className:"bg-teal-50 dark:bg-teal-900/10 border border-teal-200 dark:border-teal-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"bg-teal-100 dark:bg-teal-900/30 p-2 rounded-lg text-teal-600 dark:text-teal-400",children:e.jsx(is,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sm text-teal-800 dark:text-teal-200",children:"Smart Class Import"}),e.jsx("p",{className:"text-[10px] text-slate-500",children:"Bulk upload via CSV"})]})]}),e.jsxs("button",{onClick:()=>{te(!0),xe("UPLOAD"),me(null),ae([])},className:"w-full py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg text-xs font-bold flex items-center justify-center gap-2 shadow-sm transition-colors",disabled:_,children:[e.jsx(Re,{className:"w-4 h-4"})," Import Students"]})]}),e.jsxs(U,{className:"bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:[e.jsxs("h4",{className:"font-bold text-slate-700 dark:text-white flex items-center gap-2 text-sm mb-3",children:[e.jsx(xs,{className:"w-4 h-4 text-orange-500"})," Class Health"]}),e.jsxs("div",{className:"flex justify-between items-center text-xs mb-2",children:[e.jsx("span",{className:"text-slate-500",children:"Verified Students"}),e.jsx("span",{className:"font-bold text-green-600",children:v.total})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs mb-3",children:[e.jsx("span",{className:"text-slate-500",children:"Pending/Ghost"}),e.jsx("span",{className:"font-bold text-red-500",children:m.length})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-1.5 mb-3",children:e.jsx("div",{className:"bg-green-500 h-1.5 rounded-full",style:{width:`${v.total/(v.total+m.length||1)*100}%`}})}),e.jsxs("button",{onClick:w,disabled:m.length===0||_,className:"w-full text-xs flex items-center justify-center gap-1 bg-white dark:bg-slate-800 border border-red-200 dark:border-red-900/50 text-red-600 dark:text-red-400 py-2 rounded hover:bg-red-50 dark:hover:bg-red-900/20 disabled:opacity-50",children:[e.jsx(Ns,{className:"w-3 h-3"})," Delete All Unverified"]})]}),e.jsxs(U,{className:`border-t-4 ${_?"border-t-slate-400 opacity-80":"border-t-blue-500"} relative overflow-hidden`,children:[_&&e.jsxs("div",{className:"absolute inset-0 bg-white/60 dark:bg-slate-950/60 backdrop-blur-[1px] z-10 flex flex-col items-center justify-center text-center",children:[e.jsx(_e,{className:"w-8 h-8 text-slate-500 mb-2"}),e.jsx("p",{className:"text-sm font-bold text-slate-600 dark:text-slate-300",children:"Class Locked"}),e.jsx("p",{className:"text-[10px] text-slate-500",children:"Results submitted. Cannot add students."})]}),G&&e.jsxs("div",{className:"absolute inset-0 z-20 bg-white/95 dark:bg-slate-900/95 flex flex-col items-center justify-center text-center animate-fade-in-up",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mb-4 animate-bounce",children:e.jsx(se,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white",children:G})]}),z&&e.jsx("div",{className:"mb-4 bg-red-50 text-red-600 p-2 rounded text-xs text-center border border-red-100",children:z}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900/20 rounded-full flex items-center justify-center shrink-0",children:e.jsx(Le,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white leading-tight",children:"Add Student"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Manual Entry"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"mb-4 flex gap-4 items-center bg-slate-50 dark:bg-slate-900 p-3 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"relative w-16 h-16 shrink-0 rounded-full overflow-hidden border-2 border-slate-200 shadow-sm",children:d.photoUrl?e.jsx("img",{src:d.photoUrl,className:"w-full h-full object-cover"}):e.jsx("img",{src:`https://api.dicebear.com/7.x/avataaars/svg?seed=${d.name||"Felix"}&gender=${d.gender==="Female"?"female":"male"}`,className:"w-full h-full opacity-80"})}),e.jsx("div",{className:"flex-1 space-y-2",children:l?e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("label",{className:"cursor-pointer bg-slate-200 dark:bg-slate-700 px-3 py-1 rounded text-[10px] font-bold text-center block",children:[o?"Uploading...":"Choose File",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:Te,disabled:o})]}),e.jsx("button",{type:"button",onClick:()=>x(!1),className:"text-[10px] text-red-500",children:"Cancel"})]}):e.jsxs("div",{children:[e.jsx(D,{className:"text-xs h-8",placeholder:"Paste Image URL...",value:d.photoUrl,onChange:s=>u({...d,photoUrl:s.target.value})}),r.isPro&&e.jsx("button",{type:"button",onClick:()=>x(!0),className:"text-[10px] text-blue-600 font-bold underline mt-1 block",children:"Or Upload File"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-500 ml-1 font-bold uppercase",children:"FULL NAME *"}),e.jsx("input",{value:d.name,onChange:s=>u({...d,name:s.target.value.toUpperCase()}),onBlur:()=>Ce("name"),className:`w-full bg-white dark:bg-slate-800 font-bold rounded-lg px-4 py-2.5 outline-none border-2 ${Y.name?"border-red-500":"border-slate-300 dark:border-slate-600"}`})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-500 ml-1 font-bold uppercase",children:"Gender *"}),e.jsxs("select",{className:"w-full bg-white dark:bg-slate-800 px-3 py-2.5 outline-none font-medium border-2 rounded-lg",value:d.gender,onChange:s=>u({...d,gender:s.target.value}),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"Male",children:"Boy"}),e.jsx("option",{value:"Female",children:"Girl"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-500 ml-1 font-bold uppercase",children:"DOB *"}),e.jsx("input",{type:"date",value:d.dob,onChange:s=>u({...d,dob:s.target.value}),className:`w-full bg-white dark:bg-slate-800 font-medium rounded-lg px-3 py-2 outline-none border-2 ${Y.dob?"border-red-500":"border-slate-300 dark:border-slate-600"}`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(D,{className:"text-sm font-mono",placeholder:"Reg No (Auto)",value:d.regNo,onChange:s=>u({...d,regNo:s.target.value})}),e.jsx(D,{type:"number",className:"text-sm font-mono",placeholder:"Roll No",value:d.rollNo,onChange:s=>u({...d,rollNo:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(D,{className:"text-sm",placeholder:"Father",value:d.fatherName,onChange:s=>u({...d,fatherName:s.target.value})}),e.jsx(D,{className:"text-sm",placeholder:"Mother",value:d.motherName,onChange:s=>u({...d,motherName:s.target.value})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(V,{onClick:Ae,disabled:B,className:"w-full py-3 text-sm font-bold",children:B?"Saving...":"Save & Add Next"})})]})]}),e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[m.length>0&&e.jsxs(U,{className:"bg-orange-50 dark:bg-orange-900/10 border border-orange-200 dark:border-orange-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-orange-800 dark:text-orange-200 flex items-center gap-2",children:[e.jsx(Le,{className:"w-5 h-5"})," Pending Admissions (",m.length,")"]}),e.jsx("span",{className:"text-[10px] bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200 px-2 py-1 rounded",children:"Action Required"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3 max-h-64 overflow-y-auto pr-1 custom-scrollbar",children:m.map(s=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 rounded-xl shadow-sm border border-slate-100 dark:border-slate-800 flex items-center justify-between group hover:border-orange-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.photoUrl||`https://api.dicebear.com/7.x/avataaars/svg?seed=${s.name}`,className:"w-10 h-10 rounded-full object-cover bg-slate-100"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm text-slate-800 dark:text-white",children:s.name}),e.jsxs("p",{className:"text-[10px] text-slate-500",children:["Applied: ",new Date().toLocaleDateString()]})]})]}),e.jsx("button",{onClick:()=>De(s),className:"bg-white dark:bg-slate-800 border border-blue-200 dark:border-blue-800 text-blue-600 dark:text-blue-400 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors",children:"Review"})]},s.id))})]}),e.jsxs(U,{className:"p-0 overflow-hidden min-h-[400px] relative",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center bg-slate-50 dark:bg-slate-800",children:[e.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-blue-500"})," Class List (",y.length,")"]}),e.jsxs(V,{variant:"secondary",onClick:()=>E(!0),className:"text-xs flex items-center gap-1",disabled:_,children:[e.jsx(ms,{className:"w-3 h-3"})," Register"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700/50 text-slate-500 dark:text-slate-400 font-bold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-10",children:"Roll"}),e.jsx("th",{className:"p-3",children:"Name"}),e.jsx("th",{className:"p-3 w-24",children:"Reg No"}),e.jsx("th",{className:"p-3 w-24",children:"DOB"}),e.jsx("th",{className:"p-3 w-20 text-center",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:Se.map(s=>e.jsxs("tr",{className:"group hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"p-3 text-center text-slate-500",children:s.rollNo||"-"}),e.jsx("td",{className:"p-3 text-slate-800 dark:text-white",children:e.jsxs("div",{className:"flex items-center gap-2 font-bold",children:[s.photoUrl&&e.jsx("img",{src:s.photoUrl,className:"w-6 h-6 rounded-full object-cover"}),s.name,s.isPremium&&e.jsx(ze,{className:"w-3 h-3 text-yellow-500"})]})}),e.jsx("td",{className:"p-3 font-mono text-slate-600 dark:text-slate-300",children:s.regNo}),e.jsx("td",{className:"p-3 text-slate-500 font-mono",children:$e(s.dob)}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>P(s.id,s.name),disabled:_,className:"p-2 text-slate-400 hover:text-red-500 disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(Ye,{className:"w-4 h-4"})})})]},s.id))})]})})]})]}),O&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 animate-fade-in-up",children:e.jsxs(U,{className:"w-full max-w-2xl bg-white dark:bg-slate-900 border-t-4 border-t-blue-600 max-h-[90vh] overflow-y-auto flex flex-col p-0",children:[e.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-950",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Review Application"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Verify details before approving."})]}),e.jsx("button",{onClick:()=>fe(null),className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(ve,{className:"w-5 h-5 text-slate-500"})})]}),e.jsxs("div",{className:"p-6 grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("img",{src:O.photoUrl||`https://api.dicebear.com/7.x/avataaars/svg?seed=${O.name}`,className:"w-32 h-32 rounded-full object-cover mx-auto border-4 border-white dark:border-slate-800 shadow-lg bg-slate-100"}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-2",children:"Applicant Photo"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-900/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"font-bold text-blue-800 dark:text-blue-300 text-sm",children:"Student Details"}),e.jsxs("button",{onClick:()=>K(!Q),className:"text-xs text-blue-600 underline flex items-center gap-1",children:[e.jsx(hs,{className:"w-3 h-3"})," ",Q?"Cancel Edit":"Edit"]})]}),e.jsx("div",{className:"space-y-2 text-sm",children:Q?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"h-8 text-xs",value:N.name,onChange:s=>H({...N,name:s.target.value.toUpperCase()}),placeholder:"Name"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(D,{className:"h-8 text-xs",value:N.regNo,onChange:s=>H({...N,regNo:s.target.value}),placeholder:"Reg No"}),e.jsx("input",{type:"date",className:"h-8 text-xs bg-white dark:bg-slate-800 border rounded px-2 w-full",value:N.dob,onChange:s=>H({...N,dob:s.target.value})})]}),e.jsxs("select",{className:"h-8 text-xs bg-white dark:bg-slate-800 border rounded px-2 w-full",value:N.gender,onChange:s=>H({...N,gender:s.target.value}),children:[e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"Name:"})," ",e.jsx("span",{className:"font-bold",children:N.name})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"Reg No:"})," ",e.jsx("span",{className:"font-mono",children:N.regNo||"-"})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"DOB:"})," ",e.jsx("span",{children:$e(N.dob)})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"Gender:"})," ",e.jsx("span",{children:N.gender})]})]})})]})]}),e.jsxs("div",{className:"space-y-6 flex flex-col h-full",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-4 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-slate-700 dark:text-slate-300 text-sm mb-3",children:"Parent Information"}),e.jsx("div",{className:"space-y-2 text-sm",children:Q?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"h-8 text-xs",value:N.fatherName,onChange:s=>H({...N,fatherName:s.target.value}),placeholder:"Father's Name"}),e.jsx(D,{className:"h-8 text-xs",value:N.motherName,onChange:s=>H({...N,motherName:s.target.value}),placeholder:"Mother's Name"}),e.jsx(D,{className:"h-8 text-xs",value:N.phone,onChange:s=>H({...N,phone:s.target.value}),placeholder:"Phone"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Father:"})," ",e.jsx("span",{className:"font-bold",children:N.fatherName})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Mother:"})," ",e.jsx("span",{children:N.motherName})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Phone:"})," ",e.jsx("span",{children:N.phone})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Address:"})," ",e.jsx("span",{className:"text-xs",children:N.address||"-"})]})]})})]}),e.jsxs("div",{className:"mt-auto pt-6 border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase block mb-1",children:"Wrong Class? Transfer Request"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ve,{className:"h-9 text-xs py-0",value:ee,onChange:s=>be(s.target.value),children:[e.jsx("option",{value:"",children:"Select Target Class"}),X.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("button",{onClick:oe,disabled:!ee||pe,className:"bg-purple-100 text-purple-700 px-3 rounded-lg text-xs font-bold hover:bg-purple-200 transition-colors whitespace-nowrap",children:pe?"Moving...":e.jsxs(e.Fragment,{children:[e.jsx(us,{className:"w-3 h-3 inline mr-1"})," Move"]})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>A(O.id,"REJECT"),className:"flex-1 py-3 border border-red-200 text-red-600 rounded-xl font-bold text-sm hover:bg-red-50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"})," Reject"]}),e.jsxs("button",{onClick:Fe,disabled:_,className:"flex-[2] py-3 bg-green-600 text-white rounded-xl font-bold text-sm hover:bg-green-700 shadow-lg shadow-green-500/30 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:[e.jsx(se,{className:"w-4 h-4"})," Approve Admission"]})]})]})]})]})]})}),W&&e.jsx("div",{className:"fixed inset-0 z-[80] flex items-center justify-center bg-black/90 p-4 animate-fade-in-up",children:e.jsxs(U,{className:"w-full max-w-2xl h-[80vh] flex flex-col p-0 overflow-hidden bg-slate-50 dark:bg-slate-900 border-t-4 border-t-teal-500",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-teal-100 dark:bg-teal-900/30 rounded-lg flex items-center justify-center text-teal-600",children:e.jsx(Re,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl text-slate-800 dark:text-white",children:"Smart Class Import"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Bulk upload Students for ",r.name]})]})]}),e.jsx("button",{onClick:()=>{te(!1),me(null),q([]),ae([])},className:"text-slate-400 hover:text-slate-600",children:e.jsx(ve,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[J==="UPLOAD"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/10 p-4 rounded-xl border border-blue-100 dark:border-blue-900/30 text-sm text-slate-700 dark:text-slate-300",children:[e.jsxs("h4",{className:"font-bold mb-2 flex items-center gap-2",children:[e.jsx(Oe,{className:"w-4 h-4 text-blue-500"})," Instructions:"]}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1 text-xs",children:[e.jsx("li",{children:"Download the template below. It contains headers for Name, Parents, etc."}),e.jsxs("li",{children:[`Fill your student data. No need to specify "Class" as it's automatically set to `,e.jsx("b",{children:r.name}),"."]}),e.jsx("li",{children:"Upload the filled CSV."})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:Me,className:"w-full py-2 bg-white dark:bg-emerald-900 border border-emerald-200 dark:border-emerald-700 text-emerald-700 dark:text-emerald-200 rounded-lg text-xs font-bold flex items-center justify-center gap-2 hover:bg-emerald-50 dark:hover:bg-emerald-800 transition-colors",children:[e.jsx(qe,{className:"w-4 h-4"})," Download Class Template"]})}),e.jsxs("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-2xl p-10 text-center hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors cursor-pointer relative",children:[e.jsx("input",{type:"file",accept:".csv",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:Pe}),e.jsx(Re,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e.jsx("p",{className:"font-bold text-slate-600 dark:text-slate-300",children:"Drag & Drop or Click to Upload CSV"})]})]}),J==="MAP"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Oe,{className:"w-4 h-4"})," Map Columns"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Student Name *"}),e.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:c.name,onChange:s=>$({...c,name:s.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Header --"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Reg No / ID"}),e.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:c.regNo,onChange:s=>$({...c,regNo:s.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Header --"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Roll No"}),e.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:c.rollNo,onChange:s=>$({...c,rollNo:s.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Header --"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Gender"}),e.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:c.gender,onChange:s=>$({...c,gender:s.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Header --"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"DOB"}),e.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:c.dob,onChange:s=>$({...c,dob:s.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Header --"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Father Name"}),e.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:c.fatherName,onChange:s=>$({...c,fatherName:s.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Header --"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Mother Name"}),e.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:c.motherName,onChange:s=>$({...c,motherName:s.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Header --"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Address"}),e.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:c.address,onChange:s=>$({...c,address:s.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Header --"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Phone"}),e.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:c.phone,onChange:s=>$({...c,phone:s.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Header --"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})]})}),J==="PROCESS"&&e.jsxs("div",{className:"space-y-4",children:[re&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold mb-1",children:[e.jsx("span",{children:"Importing..."}),e.jsxs("span",{children:[ne,"%"]})]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-800 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-teal-500 h-full transition-all duration-300",style:{width:`${ne}%`}})})]}),e.jsxs("div",{className:"bg-black/80 text-green-400 font-mono text-xs p-4 rounded-xl h-64 overflow-y-auto border border-slate-700 shadow-inner",children:[ke.map((s,n)=>e.jsx("div",{className:"mb-1",children:s},n)),re&&e.jsx("div",{className:"animate-pulse",children:"_"})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 flex justify-end gap-3",children:[J==="MAP"&&e.jsxs(V,{onClick:Ee,className:"bg-teal-600 hover:bg-teal-700 text-white shadow-lg flex items-center gap-2",children:["Start Import ",e.jsx(We,{className:"w-4 h-4"})]}),J==="PROCESS"&&!re&&e.jsx(V,{onClick:()=>te(!1),className:"bg-slate-800 text-white",children:"Done"}),J==="UPLOAD"&&e.jsx(V,{variant:"secondary",onClick:()=>te(!1),children:"Cancel"})]})]})})]})},ys=({students:r,marks:y,subjects:m,isSubmitted:v,loading:p,onMarkChange:S,onSaveAll:P,onSubmitResults:A})=>{const w=[...r].sort((k,l)=>(k.rollNo||9999)-(l.rollNo||9999)),[f,E]=a.useState("TERM"),[d,u]=a.useState(!1),[B,R]=a.useState(!1),[Y,F]=a.useState(null);a.useEffect(()=>{(async()=>{const l=await b.getSchoolConfig();l!=null&&l.allowTeacherDirectPublish&&u(!0)})()},[]);const G=["CLASS_TEST","REVISION"].includes(f),I=async()=>{if(G&&d){if(!confirm(`Directly publish ${f} results? Parents will see this immediately.`))return;R(!0),A()}else A()},z=(k,l,x)=>{if(F(null),x===""||x.toUpperCase()==="AB"||x.toUpperCase()==="A"){S(k,l,x);return}const o=parseFloat(x);if(isNaN(o))return;const M=m.find(W=>W.name===l);if(M){if(o>M.maxMarks){F(`Cannot enter ${o} for ${l}. Max is ${M.maxMarks}.`);return}if(o<0)return}S(k,l,x)};return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm relative",children:[Y&&e.jsxs("div",{className:"absolute top-full left-0 right-0 bg-red-100 text-red-700 text-xs font-bold p-2 text-center border-b border-red-200 z-20 animate-fade-in-up",children:[e.jsx(Qe,{className:"w-3 h-3 inline mr-1"})," ",Y]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase block mb-1",children:"Assessment Type"}),e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-900 p-1 rounded-lg",children:[e.jsxs("button",{onClick:()=>E("TERM"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${f==="TERM"?"bg-white dark:bg-slate-800 text-blue-600 shadow-sm":"text-slate-500"}`,children:[e.jsx(ps,{className:"w-4 h-4"})," Term Exam"]}),e.jsxs("button",{onClick:()=>E("CLASS_TEST"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${f==="CLASS_TEST"?"bg-white dark:bg-slate-800 text-purple-600 shadow-sm":"text-slate-500"}`,children:[e.jsx(fs,{className:"w-4 h-4"})," Class Test"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white hidden md:block",children:"Marks Entry"}),v&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded font-bold flex items-center gap-1",children:[e.jsx(_e,{className:"w-3 h-3"})," Locked"]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs(V,{onClick:P,variant:"secondary",disabled:p||v,className:"flex-1 md:flex-none",children:[e.jsx(Ge,{className:"w-4 h-4 mr-2 inline"})," Save Draft"]}),G&&d?e.jsxs(V,{onClick:I,className:"bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg shadow-emerald-500/20 flex-1 md:flex-none",disabled:v,children:[e.jsx(Xe,{className:"w-4 h-4 mr-2 inline"})," Publish Result"]}):e.jsx(V,{onClick:A,className:v?"bg-orange-500 hover:bg-orange-600 flex-1 md:flex-none":"bg-blue-600 hover:bg-blue-700 flex-1 md:flex-none",children:v?e.jsxs(e.Fragment,{children:[e.jsx(vs,{className:"w-4 h-4 mr-2 inline"})," Request Unlock"]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-4 h-4 mr-2 inline"})," Submit to Admin"]})})]})]}),e.jsx(U,{className:"overflow-x-auto p-0",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-100 dark:bg-slate-800 text-xs uppercase font-bold text-slate-500 dark:text-slate-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-16 text-center",children:"Roll"}),e.jsx("th",{className:"p-3 w-48 sticky left-0 bg-slate-100 dark:bg-slate-800 z-10",children:"Student Name"}),m.map(k=>e.jsxs("th",{className:"p-3 text-center min-w-[80px]",children:[k.name.substring(0,10),e.jsxs("span",{className:"block text-[9px] opacity-60",children:["Max: ",k.maxMarks]})]},k.name)),e.jsx("th",{className:"p-3 w-24 text-center font-black",children:"Total"}),e.jsx("th",{className:"p-3 w-16 text-center",children:"Grade"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:w.map(k=>{const l=y[k.id];return l?e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsx("td",{className:"p-3 text-center font-mono text-slate-500",children:k.rollNo||"-"}),e.jsx("td",{className:"p-3 font-bold text-slate-700 dark:text-slate-200 sticky left-0 bg-white dark:bg-slate-900 z-10 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:k.name}),m.map(x=>e.jsx("td",{className:"p-2 text-center",children:e.jsx("input",{type:"text",className:`w-12 text-center p-1.5 rounded border outline-none font-bold transition-all focus:ring-2 focus:ring-blue-500 ${v?"bg-slate-100 text-slate-500 cursor-not-allowed":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700"}`,value:l.subjects[x.name]||"",onChange:o=>z(k.id,x.name,o.target.value),disabled:v,placeholder:"-"})},x.name)),e.jsx("td",{className:"p-3 text-center font-black text-blue-600 dark:text-blue-400",children:l.total}),e.jsx("td",{className:`p-3 text-center font-bold ${l.grade==="F"?"text-red-500":"text-green-600"}`,children:l.grade})]},k.id):null})})]})})]})},Ss=({onPostNotice:r})=>{const[y,m]=a.useState(""),[v,p]=a.useState(""),[S,P]=a.useState(""),[A,w]=a.useState(!1),[f,E]=a.useState(!1);a.useEffect(()=>{if(A){const u=setTimeout(()=>w(!1),2e3);return()=>clearTimeout(u)}},[A]);const d=async()=>{if(!y||!v){alert("Please enter title and message");return}E(!0);const u=await r(y,v,S);E(!1),u&&(m(""),p(""),P(""),w(!0))};return e.jsx("div",{className:"max-w-md mx-auto animate-fade-in-up",children:e.jsxs(U,{className:"border-t-4 border-t-blue-500 relative overflow-hidden",children:[A&&e.jsxs("div",{className:"absolute inset-0 z-10 bg-white/95 dark:bg-slate-900/95 flex flex-col items-center justify-center text-center animate-fade-in-up",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mb-4 animate-bounce",children:e.jsx(se,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white",children:S?"Scheduled!":"Notice Posted!"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900/20 rounded-full flex items-center justify-center shrink-0",children:e.jsx(Ze,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white leading-tight",children:"Post Notice"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Inform students & parents"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Title"}),e.jsx(D,{placeholder:"e.g. Exam Schedule",value:y,onChange:u=>m(u.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Message"}),e.jsx("textarea",{className:"w-full bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg p-3 text-sm h-32 resize-none",placeholder:"Type here...",value:v,onChange:u=>p(u.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Schedule for Later (Optional)"}),e.jsx(D,{type:"datetime-local",value:S,onChange:u=>P(u.target.value)})]}),e.jsxs(V,{onClick:d,disabled:f,className:"w-full flex items-center justify-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4"}),f?"Posting...":S?"Schedule Post":"Post Notice"]})]})]})})},Cs=({subjects:r,onAddSubject:y,onDeleteSubject:m,canEdit:v})=>{const[p,S]=a.useState({name:"",max:"50",pass:"18"}),[P,A]=a.useState(!1),w=async()=>{if(!p.name)return;A(!0);const f=parseInt(p.max)||50,E=parseInt(p.pass)||18,d=await y(p.name,f,E);A(!1),d&&S({name:"",max:"50",pass:"18"})};return e.jsx("div",{className:"max-w-2xl mx-auto animate-fade-in-up",children:e.jsxs(U,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-2 rounded-lg text-purple-600 dark:text-purple-400",children:e.jsx(es,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white",children:"Manage Subjects"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Add or remove subjects for this class."})]})]}),e.jsxs("div",{className:"space-y-3 mb-8",children:[r.map((f,E)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-700 dark:text-slate-200",children:f.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Max: ",f.maxMarks," | Pass: ",f.passMarks]})]}),v&&e.jsx("button",{onClick:()=>m(E),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(Ye,{className:"w-4 h-4"})})]},E)),r.length===0&&e.jsx("p",{className:"text-center text-slate-400 text-sm",children:"No subjects added."})]}),v?e.jsxs("div",{className:"bg-slate-100 dark:bg-slate-900 p-4 rounded-xl",children:[e.jsx("h4",{className:"text-sm font-bold text-slate-600 dark:text-slate-400 mb-3 uppercase",children:"Add New Subject"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx(D,{placeholder:"Subject Name (e.g. Maths)",value:p.name,onChange:f=>S({...p,name:f.target.value}),className:"flex-[2]"}),e.jsx("div",{className:"flex-1",children:e.jsx(D,{type:"number",placeholder:"Max",value:p.max,onChange:f=>S({...p,max:f.target.value})})}),e.jsx("div",{className:"flex-1",children:e.jsx(D,{type:"number",placeholder:"Pass",value:p.pass,onChange:f=>S({...p,pass:f.target.value})})})]}),e.jsx(V,{onClick:w,disabled:P,className:"w-full flex justify-center items-center gap-2",children:P?"Adding...":e.jsxs(e.Fragment,{children:[e.jsx(gs,{className:"w-4 h-4"})," Add Subject"]})})]}):e.jsx("div",{className:"text-center p-4 bg-yellow-50 text-yellow-700 text-sm rounded-lg border border-yellow-200",children:"Subject editing is disabled by Admin."})]})})},Ts=({students:r,classId:y})=>{const[m,v]=a.useState("DAILY"),[p,S]=a.useState(new Date().toISOString().split("T")[0]),[P,A]=a.useState("Term 1"),[w,f]=a.useState({}),[E,d]=a.useState(!1),[u,B]=a.useState(!1),[R,Y]=a.useState(50);a.useEffect(()=>{F()},[m,p,P]);const F=async()=>{d(!0);const l={};m==="DAILY"?((await b.getAttendanceByDate(y,p)).forEach(o=>{l[o.studentId]=o.status}),r.forEach(o=>{l[o.id]||(l[o.id]="PRESENT")})):((await b.getAttendanceByTerm(y,P)).forEach(o=>{l[o.studentId]={present:o.presentDays,total:o.workingDays},o.workingDays&&Y(o.workingDays)}),r.forEach(o=>{l[o.id]||(l[o.id]={present:0,total:R})})),f(l),d(!1)},G=l=>{f(x=>{const o=x[l],M=o==="PRESENT"?"ABSENT":o==="ABSENT"?"LATE":"PRESENT";return{...x,[l]:M}})},I=(l,x)=>{const o=parseInt(x)||0;f(M=>({...M,[l]:{present:o,total:R}}))},z=async()=>{B(!0);const l=r.map(o=>({studentId:o.id,classId:y,date:p,status:w[o.id],type:"DAILY"})),x=await b.markDailyAttendance(l);B(!1),x.success?alert("Daily Attendance Saved!"):alert("Failed to save.")},k=async()=>{B(!0);const l=r.map(o=>{var M;return{studentId:o.id,classId:y,term:P,workingDays:R,presentDays:((M=w[o.id])==null?void 0:M.present)||0,status:"PRESENT",type:"SUMMARY"}}),x=await b.saveSummaryAttendance(l);B(!1),x.success?alert("Term Attendance Saved!"):alert("Failed to save.")};return e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 gap-4",children:[e.jsxs("div",{className:"flex items-center bg-slate-100 dark:bg-slate-900 p-1 rounded-lg border border-slate-200 dark:border-slate-800",children:[e.jsxs("button",{onClick:()=>v("DAILY"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${m==="DAILY"?"bg-white dark:bg-slate-800 shadow text-blue-600 dark:text-blue-400":"text-slate-500"}`,children:[e.jsx(ss,{className:"w-4 h-4"})," Daily Tracker"]}),e.jsxs("button",{onClick:()=>v("SUMMARY"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${m==="SUMMARY"?"bg-white dark:bg-slate-800 shadow text-purple-600 dark:text-purple-400":"text-slate-500"}`,children:[e.jsx(js,{className:"w-4 h-4"})," Term Summary"]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[m==="DAILY"?e.jsx(D,{type:"date",value:p,onChange:l=>S(l.target.value),className:"font-bold text-sm"}):e.jsxs(e.Fragment,{children:[e.jsxs(Ve,{value:P,onChange:l=>A(l.target.value),className:"w-32 text-sm py-2",children:[e.jsx("option",{children:"Term 1"}),e.jsx("option",{children:"Term 2"}),e.jsx("option",{children:"Finals"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 dark:bg-slate-900 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-800",children:[e.jsx("span",{className:"text-[10px] text-slate-500 font-bold uppercase whitespace-nowrap",children:"Total Days:"}),e.jsx("input",{type:"number",className:"w-12 bg-transparent text-sm font-bold text-center outline-none",value:R,onChange:l=>Y(parseInt(l.target.value)||0)})]})]}),e.jsx(V,{onClick:m==="DAILY"?z:k,disabled:u,className:"bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-500/20",children:u?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"})," Save"]})})]})]}),e.jsx(U,{className:"p-0 overflow-hidden min-h-[400px]",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 text-slate-500 dark:text-slate-400 font-bold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 w-16 text-center",children:"Roll"}),e.jsx("th",{className:"p-4",children:"Student Name"}),e.jsx("th",{className:"p-4 text-center",children:"Status / Days Present"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:r.map(l=>{var x,o,M;return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"p-4 text-center text-slate-500 font-mono",children:l.rollNo||"-"}),e.jsx("td",{className:"p-4 font-bold text-slate-700 dark:text-slate-200",children:l.name}),e.jsx("td",{className:"p-4 text-center",children:E?e.jsx("div",{className:"h-8 w-24 bg-slate-100 dark:bg-slate-800 rounded animate-pulse mx-auto"}):m==="DAILY"?e.jsxs("button",{onClick:()=>G(l.id),className:`w-32 py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all ${w[l.id]==="PRESENT"?"bg-green-100 text-green-700 border border-green-200":w[l.id]==="ABSENT"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[w[l.id]==="PRESENT"&&e.jsx(se,{className:"w-4 h-4"}),w[l.id]==="ABSENT"&&e.jsx(ts,{className:"w-4 h-4"}),w[l.id]==="LATE"&&e.jsx(as,{className:"w-4 h-4"}),w[l.id]||"PRESENT"]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"relative",children:e.jsx("input",{type:"number",className:"w-16 p-2 text-center font-bold bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none",value:((x=w[l.id])==null?void 0:x.present)||0,onChange:W=>I(l.id,W.target.value)})}),e.jsxs("span",{className:"text-slate-400 text-xs",children:["/ ",R]}),e.jsxs("span",{className:`text-xs font-bold ml-2 ${((o=w[l.id])==null?void 0:o.present)/R<.75?"text-red-500":"text-green-500"}`,children:[R>0?Math.round(((M=w[l.id])==null?void 0:M.present)/R*100):0,"%"]})]})})]},l.id)})})]})})]})},Os=({user:r})=>{const y=ls(),[m,v]=a.useState("students"),[p,S]=a.useState([]),[P,A]=a.useState([]),[w,f]=a.useState({}),[E,d]=a.useState(!1),[u,B]=a.useState(r.subjects),[R,Y]=a.useState(r.submissionStatus==="SUBMITTED"),[F,G]=a.useState(!1),[I,z]=a.useState({name:r.teacherName||"",photo:r.teacherPhoto||""}),[k,l]=a.useState(!1),[x,o]=a.useState(null),[M,W]=a.useState(!1),[te,J]=a.useState(""),[xe,Ie]=a.useState([]),[me,L]=a.useState([]),[ae,le]=a.useState(!1),[we,re]=a.useState({ai:5,results:1}),[he,ke]=a.useState(2),[q,ne]=a.useState([]),[ue,c]=a.useState(!1),[$,O]=a.useState(0),[de,Q]=a.useState(!1),[K,N]=a.useState([]);a.useEffect(()=>{X(),ye(),H()},[]);const H=async()=>{const t=await b.getNotifications(r.id,"TEACHER");ne(t),O(t.filter(s=>!s.isRead).length)},ee=async t=>{await b.markNotificationRead(t),ne(s=>s.map(n=>n.id===t?{...n,isRead:!0}:n)),O(s=>Math.max(0,s-1))},be=async()=>{const t=await b.getTeacherTransactionHistory(r.id);N(t),Q(!0)},X=async()=>{d(!0);const[t,s]=await Promise.all([b.getSchoolConfig(),b.getGlobalSettings()]);if(o(t),G((t==null?void 0:t.allowTeacherSubjectEdit)??!1),s.FEATURE_COSTS)try{const g=JSON.parse(s.FEATURE_COSTS);re(g)}catch{}s.AI_TRIAL_LIMIT&&ke(parseInt(s.AI_TRIAL_LIMIT)||2);const n=(t==null?void 0:t.feeManagerRole)||"ADMIN",j=(await b.getFeeStructures(r.id)).filter(g=>g.collectedBy==="TEACHER"||g.collectedBy==="BOTH"||n==="TEACHER"||n==="HYBRID");L(j),le(j.length>0);const h=await b.getStudentsByClass(r.id);S(h);const T={};for(const g of h){const C=await b.getMarks(g.id,"Term 1");C?T[g.id]=C:T[g.id]={studentId:g.id,subjects:u.reduce((je,Ne)=>({...je,[Ne.name]:0}),{}),total:0,grade:"F",term:"Term 1"}}f(T);const Z=await b.getPendingAdmissions(r.id);A(Z),Z.length>0&&((t==null?void 0:t.admissionApprover)==="TEACHER"||(t==null?void 0:t.admissionApprover)==="BOTH"||!(t!=null&&t.admissionApprover))&&v("students"),d(!1)},ye=async()=>{const t=await b.getAssessmentPrograms("TEACHER",r.id);Ie(t)},pe=(t,s,n)=>{f(i=>{const j={...i[t]};return j.subjects={...j.subjects,[s]:n},{...i,[t]:j}})},ge=async()=>{for(const t of Object.values(w))await b.saveMarks(t);alert("Saved!")},_=async()=>{(await b.toggleClassSubmission(r.id,!0)).success&&Y(!0)},Se=async(t,s)=>{s==="APPROVE"?await b.verifyStudent(t,r.teacherName):await b.rejectAdmission(t),X()},Ce=async t=>{await b.deleteStudent(t),X()},Te=async()=>{await b.deleteUnverifiedStudents(r.id),X()},Ae=async(t,s,n)=>{const i=[...u,{name:t,maxMarks:s,passMarks:n}];return await b.updateClassSubjects(r.id,i),B(i),!0},Me=async t=>{const s=[...u];s.splice(t,1),await b.updateClassSubjects(r.id,s),B(s)},Pe=async(t,s,n)=>(await b.createCampusPost(r.schoolId,r.teacherName||"Teacher",s,"TEACHER","NOTICE",t,n),!0),Ee=async()=>{await b.updateClassDetails(r.id,{teacherName:I.name}),l(!1)},De=async t=>{},oe={total:p.length,male:p.filter(t=>t.gender==="Male").length,female:p.filter(t=>t.gender==="Female").length},fe=()=>m==="students"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center gap-1 bg-blue-50 dark:bg-blue-900/40 px-2 py-1 rounded",children:e.jsxs("span",{className:"text-xs font-bold text-blue-700 dark:text-blue-300",children:[oe.male," B"]})}),e.jsx("div",{className:"flex items-center gap-1 bg-pink-50 dark:bg-pink-900/40 px-2 py-1 rounded",children:e.jsxs("span",{className:"text-xs font-bold text-pink-700 dark:text-pink-300",children:[oe.female," G"]})})]}):null,ce=()=>{const t=x==null?void 0:x.teacherQuota;return!t||t.frequency==="UNLIMITED"?null:e.jsxs("div",{className:"flex items-center gap-2 text-[10px] bg-purple-50 dark:bg-purple-900/20 text-purple-700 px-3 py-1 rounded border border-purple-100 dark:border-purple-800 cursor-pointer hover:bg-purple-100",onClick:be,children:[e.jsx(os,{className:"w-3 h-3 fill-current"}),e.jsxs("span",{children:["Limit: ",t.limit]})]})};return e.jsxs("div",{className:"pb-20 relative animate-fade-in-up",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700 p-3 mb-4 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsxs("div",{className:"relative group shrink-0",children:[I.photo?e.jsx("img",{src:I.photo,className:"w-12 h-12 rounded-lg object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900 rounded-lg flex items-center justify-center text-blue-600 dark:text-blue-300",children:e.jsx(ws,{className:"w-6 h-6"})}),k&&e.jsxs("label",{className:"absolute inset-0 bg-black/50 rounded-lg flex items-center justify-center cursor-pointer",children:[e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:De}),e.jsx(rs,{className:"w-4 h-4 text-white"})]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg font-black text-blue-600 dark:text-blue-400",children:r.name}),k?e.jsxs("div",{className:"space-y-1",children:[e.jsx("input",{className:"bg-slate-50 border rounded px-1 text-xs",value:I.name,onChange:t=>z({...I,name:t.target.value})}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:Ee,className:"text-[10px] bg-green-100 text-green-700 px-2 rounded",children:"Save"}),e.jsx("button",{onClick:()=>W(!0),className:"text-[10px] bg-yellow-100 text-yellow-700 px-2 rounded",children:"Pass"})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:I.name||"Class Teacher"}),e.jsx("button",{onClick:()=>l(!0),className:"text-slate-400",children:e.jsx(bs,{className:"w-3 h-3"})})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[ce(),e.jsxs("button",{onClick:()=>c(!0),className:"relative p-2 bg-slate-100 dark:bg-slate-700 rounded-full text-slate-600 hover:bg-slate-200",children:[e.jsx(He,{className:"w-4 h-4"}),$>0&&e.jsx("span",{className:"absolute top-0 right-0 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white"})]}),e.jsx("button",{onClick:()=>y(`/school/${r.schoolId}`),className:"p-2 bg-slate-100 dark:bg-slate-700 rounded-full text-slate-600",title:"Visit School Home",children:e.jsx(ns,{className:"w-4 h-4"})}),fe()]})]}),e.jsx("div",{className:"flex justify-between items-center mb-6 overflow-x-auto pb-2",children:e.jsx("div",{className:"flex bg-slate-200 dark:bg-slate-700 p-1 rounded-lg max-w-full",children:["students","subjects","marks","attendance","exams","assessments","reports","fees"].filter(t=>t!=="fees"||ae).map(t=>e.jsx("button",{onClick:()=>v(t),className:`px-4 py-2 rounded-md text-sm font-bold capitalize whitespace-nowrap ${m===t?"bg-white dark:bg-slate-800 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:t},t))})}),e.jsxs("div",{className:"mt-4",children:[m==="students"&&e.jsx(ks,{user:r,students:p,pendingAdmissions:P,stats:oe,sortingMethod:x==null?void 0:x.sortingMethod,onRefresh:X,onDeleteStudent:Ce,onAdmissionAction:Se,onCleanJunk:Te}),m==="subjects"&&e.jsx(Cs,{subjects:u,onAddSubject:Ae,onDeleteSubject:Me,canEdit:F}),m==="marks"&&e.jsx(ys,{students:p,marks:w,subjects:u,isSubmitted:R,loading:E,onMarkChange:pe,onSaveAll:ge,onSubmitResults:_}),m==="attendance"&&e.jsx(Ts,{students:p,classId:r.id}),m==="exams"&&e.jsx(cs,{classId:r.id,featureCosts:we,aiTrialLimit:he}),m==="reports"&&e.jsx(Ss,{onPostNotice:Pe}),m==="assessments"&&e.jsx("div",{className:"text-center py-10 text-slate-400",children:"Assessments Module coming soon."}),m==="fees"&&e.jsx("div",{className:"text-center py-10 text-slate-400",children:"Fees Module coming soon."})]}),de&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 animate-fade-in-up",children:e.jsxs(U,{className:"w-full max-w-md relative max-h-[80vh] flex flex-col p-0 overflow-hidden bg-white dark:bg-slate-900 border-t-4 border-t-purple-500",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-950",children:[e.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx(ds,{className:"w-4 h-4"})," Usage Statement"]}),e.jsx("button",{onClick:()=>Q(!1),children:e.jsx(ve,{className:"w-5 h-5 text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[K.length===0&&e.jsx("p",{className:"text-center text-slate-400 text-sm py-8",children:"No usage recorded recently."}),e.jsx("div",{className:"space-y-3",children:K.map(t=>e.jsxs("div",{className:"flex justify-between items-center text-sm p-2 border-b border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-700 dark:text-slate-300",children:t.description}),e.jsx("p",{className:"text-[10px] text-slate-500",children:new Date(t.createdAt).toLocaleString()})]}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"font-bold text-red-500",children:["-",t.amount," CR"]})})]},t.id))})]})]})}),ue&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in-up",onClick:()=>c(!1),children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-sm rounded-3xl p-6 shadow-2xl relative",onClick:t=>t.stopPropagation(),children:[e.jsxs("h3",{className:"font-bold text-lg mb-4 dark:text-white flex items-center gap-2",children:[e.jsx(He,{className:"w-5 h-5 text-blue-500"})," Notifications"]}),e.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar",children:q.length>0?q.map(t=>e.jsxs("div",{onClick:()=>!t.isRead&&ee(t.id),className:`p-3 rounded-xl border transition-all cursor-pointer ${t.isRead?"bg-slate-50 dark:bg-slate-800 border-slate-100 dark:border-slate-700":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded ${t.type==="ALERT"?"bg-red-100 text-red-600":"bg-slate-200 text-slate-600"}`,children:t.type}),e.jsx("span",{className:"text-[10px] text-slate-400",children:new Date(t.createdAt).toLocaleDateString()})]}),e.jsx("h4",{className:"font-bold text-sm text-slate-800 dark:text-white",children:t.title}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300 mt-1",children:t.message}),!t.isRead&&e.jsxs("div",{className:"mt-2 text-[10px] text-blue-500 font-bold flex items-center gap-1",children:[e.jsx(se,{className:"w-3 h-3"})," Mark Read"]})]},t.id)):e.jsx("p",{className:"text-center text-slate-400 text-sm py-8",children:"No notifications."})}),e.jsx("button",{onClick:()=>c(!1),className:"w-full mt-4 py-3 bg-slate-100 dark:bg-slate-800 rounded-xl font-bold text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-200",children:"Close"})]})})]})};export{Os as default};
